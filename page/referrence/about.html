<!doctype html>
<html lang="en">
    
    
  <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>💵 Attack dashboard</title>  <!--#change the title of the page-->
    
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css">
        <head><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.css">
            <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.4.1/echarts.min.js"></script>
            <style>
                 td, th {
                 text-align: center;
                 padding: 1%;
                 border: 1px solid;  

                }
                
                table {
                    margin-top: 30px ;
                  width: 100%;
                  border-collapse: collapse;
                  border: 1px solid;  
                }
            </style>
    
  </head>
  
  
  <body>

<!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top">
        <div class="container">
            
            <a class="navbar-brand" href="https://www.optimism.io/"> <!--#change-->
                <h2 style="background:-webkit-linear-gradient(#fb93a4,#fa0303 );
                -webkit-background-clip:text;-webkit-text-fill-color:transparent">Euler Hacked</h2><!--#change--> 
            </a><!--#change brand link and title-->

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarResponsive">
              <ul class="navbar-nav ms-auto">
                <li class="nav-item active">
                        <a class="nav-link aa" href="../../index.html">Home</a>  <!--#change-->
                </li>

                <li class="nav-item active">
                        <a class="nav-link aa" href="../referrence/about.html">Resource</a>  <!--#change-->
                </li>


        </ul>
            </div>
        </div>

 

    </nav>


<!-- Page Content -->
    <section class="py-5">
            <div class="container">
                <div class="raw">
                  <div class="raw"> <img src="../img/discord-hacking.gif"style="width:100%;height :500px ;" ></div>

                <h1 class=" mb-5 mt-5 aa" style="font-weight: bold;"> Referrence</h1> <!--#change-->

                <table style="border-collapse:collapse;font-size:0.9em;font-family:sans-serif">
                <thead style="font-size: medium;">
                    <tr style="box-shadow:0 0 20px rgba(0, 0, 0, 0.15)">
                      <th><code></code></th>
                      <th><code>Websites</code></th>
                    </tr>
                </thead>
                <tbody>
                  
                  <tr>
                    <td><a href=""target="_blanck"> </a></td>
                    <td><a href="https://geniidata.com/"target="_blanck">source</a></td>
                  </tr>
                  <tr>
                    <tr>
                      <td><a href=""target="_blanck"> </a></td>
                      <td><a href="https://medium.com/@omniscia.io/euler-finance-incident-post-mortem-1ce077c28454"target="_blanck">source</a></td>
                    </tr>
                    <tr>
                      <td><a href=""target="_blanck"></a></td>
                      <td><a href="https://graph.org/Euler-Hacker-Analysis-03-13"target="_blanck">source</a></td>
                    </tr>
                    <tr>
                      <td><a href=""target="_blanck"></a></td>
                      <td><a href="https://mihanblockchain.com/euler-finance-197m-stolen-with-flash-loan/"target="_blanck">source</a></td>
                    </tr>
                  
                    <tr>
                      <td><a href=""target="_blanck"></a></td>
                      <td><a href="https://twitter.com/eulerfinance/status/1636126837423366145"target="_blanck">source</a></td>
                    </tr>                  
                    <tr>
                      <td><a href=""target="_blanck"></a></td>
                      <td><a href="https://twitter.com/officer_cia/status/1635214159100141569?ref_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1635214159100141569%7Ctwgr%5E6f170c6ed5cdf5562555fe4938b860937471685b%7Ctwcon%5Es1_&ref_url=https%3A%2F%2Ftelegra.ph%2Fembed%2Ftwitter%3Furl%3Dhttps3A2F2Ftwitter.com2Fofficer_cia2Fstatus2F1635214159100141569"target="_blanck">source</a></td>
                    </tr>
                  
                    <tr>
                      <td><a href=""target="_blanck"></a></td>
                      <td><a href="https://twitter.com/peckshield/status/1635234070727913473"target="_blanck">source</a></td>
                    </tr>
                    <tr>
                      <td><a href=""target="_blanck"></a></td>
                      <td><a href="https://defillama.com/hacks"target="_blanck">source</a></td>
                    </tr>                    

                  
                  </tbody>
                </table>


                <p  class="mt-5" style="font-family:serif"><code>query : </code><a href="https://flipsidecrypto.xyz/edit/queries/14060997-a7ab-407c-b66d-4b5431bfe1c4">link</a></p>
                <p class="mt-5" style="font-family:serif"><code>query : </code><a href="https://flipsidecrypto.xyz/edit/queries/4db7b90d-b616-4c7d-b349-7f5092d64d20">link</a></p>
                <p class="mt-5" style="font-family:serif"><code>query : </code><a href="https://flipsidecrypto.xyz/edit/queries/a7256375-b70d-4ccc-9f53-971826b73f80">link</a></p>
                <p class="mt-5" style="font-family:serif"> <code>query : </code><a href="https://flipsidecrypto.xyz/edit/queries/8cb60719-15fb-4842-aa09-9d34baa2a0e8">link</a></p>
                <p class="mt-5" style="font-family:serif"> <code>query : <a href="https://flipsidecrypto.xyz/edit/queries/1c456377-b1d9-4592-a2ca-406763c882a2">link</a> </code></p>


                <p class="mt-5" style="font-family:serif"> <code>credit from : </code>   <a href="https://geniidata.com/user/GivenX/euler-finance-dashboard"target="_blanck">Link</a></p>
 <p class="mt-5" style="font-family:serif"><code>query : </code> with AssetStatus as (
  select 
      block_time,
      concat('0x', substring(topic2,27, 40)) as underlying,
      bytea2Numeric(substring(data, 3+64*0, 64)) as totalBalances,
      bytea2Numeric(substring(data, 3+64*1, 64)) as totalBorrows,
      bytea2Numeric(substring(data, 3+64*2, 64)) as reserveBalance,
      bytea2Numeric(substring(data, 3+64*3, 64)) as poolSize,
      bytea2Numeric(substring(data, 3+64*4, 64)) as interestAccumulator,
      bytea2Numeric(substring(data, 3+64*5, 64)) as interestRate
  from ethereum.logs
  where topic1 = '0x2f2d732e1a7a15fe7a2e51d3482efe83ff791579cebc5e3cd12cd2064374bc7f' --AssestStatus
  and contract_address = '0x27182842e098f60e3d576794a5bffb0777e025d3'
),
tvl as (
  select 
      date_trunc('day', block_time) as day,
      symbol,
      avg(totalBalances / pow(10,18)) as total_supply_etoken,
      avg(totalBorrows / pow(10,18)) as total_borrowed_dtoken,
      avg(reserveBalance / pow(10,18)) as reserves,
      avg(poolSize / pow(10,18)) as available_to_borrow
  from AssetStatus as gov
  join models.dim_tokens_info as tokens on gov.underlying = tokens.contract_address
  group by 1,2
),
prices as (
  SELECT
      date_trunc('day', minute) as day,
      symbol,
      avg(price) as daily_price
  from models.fact_tokens_prices
  group by 1,2
),
tvl_usd as (
  select
      tvl.day,
      daily_price ,
              case 
      when tvl.symbol  ='USDC' then 'USDC'
       when tvl.symbol  ='WETH' then 'WETH'
        when tvl.symbol  ='wstETH' then 'wstETH'
         when tvl.symbol  ='WBTC' then 'WBTC'
          when tvl.symbol  ='stETH' then 'stETH'
           when tvl.symbol  ='DAI' then 'DAI'
           end as symbol  ,
      reserves,
      available_to_borrow,
      total_supply_etoken * daily_price as dailySupply,
      total_borrowed_dtoken * daily_price as dailyBorrows,
      (reserves + available_to_borrow) * daily_price as tvl
  from tvl inner join prices as p on tvl.day = p.day and tvl.symbol = p.symbol 
  and tvl.day > '2023-01-01'
  order by 1 desc
)
select 
split(day,'00:00:00')[0] as day,
(sum(reserves)) as reserves ,
  (sum(available_to_borrow)) as  available_to_borrow,
     (sum(dailySupply)) dailySupply,
     (sum(dailyBorrows)) dailyBorrows,
     (sum(tvl)) tvl,
      symbol ,daily_price
from tvl_usd
where symbol is not null
group by 1,7,daily_price
order by day</p>
 <p class="mt-5" style="font-family:serif"><code>query : </code> with withdrawals_raw as (
  select
  block_time,
  concat('0x', substring(topic2, 27, 40)) as underlying,
  --concat('0x', substring(topic3, 27, 40)) as depositor,
  bytea2Numeric(substring(data, 3, 64)) as amount  
from ethereum.logs
where contract_address = '0x27182842e098f60e3d576794a5bffb0777e025d3' -- Euler contract_address
and topic1 = '0x9b1bfa7fa9ee420a16e124f794c35ac9f90472acc99140eb2f6447c714cad8eb' --withdrawals
),
withdrawals as (
  select 
      date_trunc('day', block_time) as day,
      underlying,
      sum(amount) / pow(10, 18) as dailyWithdrawals
  from withdrawals_raw
  group by 1, 2
),
prices as (
  SELECT
      date_trunc('day', minute) as day,
      contract_address,
      symbol,
      avg(price) as daily_price
  from models.fact_tokens_prices
  group by 1,2,3
)
select
 split(w.day,'00:00:00')[0] as day,
  underlying,
  symbol,
  dailyWithdrawals * daily_price as dailywithdrawals_usd
from withdrawals as w
left join prices as p on w.day = p.day and w.underlying = p.contract_address
where w.day >= '2023-01-01' and symbol in ('USDC','WBTC','WETH','DAI','wstETH','stETH')
order by 1</p>
 <p class="mt-5" style="font-family:serif"> <code>query : </code>with deposits_raw as (
  select
  block_time,
  concat('0x', substring(topic2, 27, 40)) as underlying,
  --concat('0x', substring(topic3, 27, 40)) as depositor,
  bytea2Numeric(substring(data, 3, 64)) as amount  
from ethereum.logs
where contract_address = '0x27182842e098f60e3d576794a5bffb0777e025d3' -- Euler contract address
and topic1 = '0x5548c837ab068cf56a2c2479df0882a4922fd203edb7517321831d95078c5f62' --Deposits
),
deposits as (
  select 
      date_trunc('day', block_time) as day,
      underlying,
      sum(amount) / pow(10, 18) as dailyDeposits
  from deposits_raw
  group by 1, 2
),
prices as (
  SELECT
      date_trunc('day', minute) as day,
      contract_address,
      symbol,
      avg(price) as daily_price
  from models.fact_tokens_prices
  group by 1,2,3
)
select
 split(d.day,'00:00:00')[0] as day,
  underlying,
  symbol,
  dailyDeposits * daily_price as dailyDeposits_usd
from deposits as d
left join prices as p on d.day = p.day and d.underlying = p.contract_address
where d.day >= '2023-01-01' and symbol in ('USDC','WBTC','WETH','DAI','wstETH','stETH')
order by 1</p>

            </div>
    </section>








    
    
    
    
    <div class="footer-basic">
        <footer >
            <div class="social">
                    <a  target="_blank" href="https://github.com/lordking1234"><i class="icon ion-social-github"></i></a>  <!--#change link -->
                    <a  target="_blank" href="https://twitter.com/MRSoltanii"><i class="icon ion-social-twitter"></i></a>  <!--#change link-->
                    <a  target="_blank" href="https://www.linkedin.com/in/mohammad-reza-soltani-62009523b/"><i class="icon ion-social-linkedin"></i></a>  <!--#change link-->
             </div>
             <ul class="list-inline">
                    <li class="list-inline-item"><a  target="_blank" href="https://flipsidecrypto.xyz/">Flipside </a></li><!--#change link & text-->
                    <li class="list-inline-item"><a  target="_blank" href="https://metricsdao.xyz/">Metrics dao</a></li><!--#change link & text-->
                    <li class="list-inline-item"><div class="dropdown">
                        <button class="btn btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Buy me a coffee 🍵
                        </button>
                        <ul class="dropdown-menu">
                          <li><p class="dropdown-item" style="font-weight:bold ; ">Thanks you 💗</p></li>
                          <li><p class="dropdown-item">
                            <button onclick="myFunction()" style ="border: none; font-weight:400 ; ">
                                  Click to copy metamask address <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
                                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"></path>
                                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"></path>
                                    </svg>
                            </button>
                        </ul>
                      </div></li><!--#change link & text-->
             </ul>
             <p class="copyright">Built by Lordking 👑</p> <!--#change-->
        </footer>
    </div>
</footer>    
<!--copy to clipbord-->
                    <input type="text" value="0x7af2d9a872cbb1bc19fcbd75a4241776ab63dcca" id="myInput" style="visibility :hidden">
                    <script>
                                function myFunction() {
                                var copyText = document.getElementById("myInput");
                                copyText.select();
                                copyText.setSelectionRange(0, 99999); 
                                navigator.clipboard.writeText(copyText.value);
                                }
                    </script>





    
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.bundle.min.js"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.css">
        <link rel="stylesheet" href="about.css">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
         <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.4.1/echarts.min.js"></script>
         <script src="about.css"></script>
         <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>

    
    
  </body>
</html> 
